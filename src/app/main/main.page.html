<ion-header *ngIf="!dataService.initialized">
  <ion-toolbar>
    <ion-buttons slot="end">
      <ion-button *ngIf="data_button" [disabled]="data_button_disabled" (click)="downloadData()">Download Data</ion-button>
      <ion-button *ngIf="image_button" [disabled]="image_button_disabled" (click)="downloadArtwork()">Download Artwork</ion-button>
    </ion-buttons>
    <ion-title class="title-bar">{{ data_message }}</ion-title>
    <div class="progress-bar-container">
      <progress-bar 
        [progress]="data_progress" 
        [color]="'#488aff'">
      </progress-bar>
    </div>
  </ion-toolbar>
</ion-header>
<ion-content padding>
  <div class="squadron-container">
    <div class="squadron-header"></div>
    <div [class]="squadronCss()" *ngFor="let squadron of squadrons">
      <div class="squadron-header">
        <ion-toolbar>
          <span class="squadron-name">
            <xwing-icon [name]="squadron.faction"></xwing-icon>&nbsp;
            {{ squadron.name }} ( {{ squadron.pointsDestroyed }} / {{ squadron.points}} )
          </span>
          <ion-buttons slot="end">
            <ion-button (click)="presentDamageDeckActionsPopover($event, squadron)">
              <span class="damage-deck-summary"><xwing-icon [name]="'hit'" class="damage-deck-icon"></xwing-icon>
                <span class="damage-deck-summary-text">{{ squadron.damagedeck.length}}</span></span>
            </ion-button>
            <ion-button (click)="removeSquadron(squadron)">
              <ion-icon name="close"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </div>
      <xws-pilot 
        *ngFor="let pilot of squadron.pilots" 
        [pilot]="pilot" 
        [faction]="squadron.faction"
        [squadron]="squadron"
        [class]="pilotCss()"></xws-pilot>
    </div>
  </div>
  <ion-fab *ngIf="dataService.initialized" vertical="bottom" horizontal="end" slot="fixed">
    <ion-fab-button>
      <ion-icon name="more"></ion-icon>
    </ion-fab-button>
    <ion-fab-list side="top">
      <ion-fab-button *ngIf="squadrons.length > 0" class="recharge-all-button" (click)="askReset()">
        <xwing-icon [name]="'reload'"></xwing-icon>
      </ion-fab-button>
      <ion-fab-button *ngIf="snapshots.length > 1" (click)="askUndo()">
        <ion-icon name="undo"></ion-icon>
      </ion-fab-button>
      <ion-fab-button *ngIf="squadrons.length > 0" class="recharge-all-button" (click)="askRechargeRecurring()">
        <xwing-icon [name]="'charge'"></xwing-icon>
      </ion-fab-button>
      <ion-fab-button *ngIf="squadrons.length < 2" (click)="xwsAddButton()">
        <ion-icon name="add"></ion-icon>
      </ion-fab-button>
    </ion-fab-list>
  </ion-fab>
  <ion-fab *ngIf="!platform.is('mobile')" vertical="bottom" horizontal="start">
      <ion-fab-button href="./about"><ion-icon name="help"></ion-icon></ion-fab-button>
  </ion-fab>
</ion-content>
